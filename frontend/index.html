<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WordPress AI 内容自动化引擎</title>
    <link rel="icon" type="image/svg+xml" href="assets/logo-icon.svg" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header class="page-header">
      <div class="logo-container">
        <img src="assets/logo.svg" alt="WordPress AI 内容自动化引擎" class="main-logo" />
      </div>
      <h1>WordPress AI 内容自动化引擎</h1>
      <p>输入长尾关键词和页面信息，一键生成并发布到 WordPress。系统会自动使用选定的模板和默认配置。</p>
    </header>

    <main>
      <section class="card">
        <form id="generator-form">
          <fieldset>
            <legend>⚙️ 后端配置</legend>
            <div class="form-row">
              <label for="backendUrl">后端 API 地址</label>
              <input type="url" id="backendUrl" name="backendUrl" value="" required />
              <small>系统会自动检测并填充后端地址。如果无法自动检测，请手动输入（例如：http://192.168.110.32:4000）</small>
            </div>
          </fieldset>

          <!-- WordPress 凭据已隐藏，使用默认值 -->
          <fieldset style="display: none;">
            <legend>🔐 WordPress 凭据</legend>
            <div class="form-row">
              <label for="wpUrl">WordPress 站点 URL</label>
              <input type="url" id="wpUrl" name="wpUrl" value="https://vertu.com/" required />
            </div>
            <div class="form-row">
              <label for="wpUsername">WordPress 用户名或邮箱</label>
              <input type="text" id="wpUsername" name="wpUsername" value="zicuo" placeholder="请输入 WordPress 用户名或邮箱地址" required />
              <small>⚠️ 重要：这不是应用密码的名称！这是登录 WordPress 后台时使用的用户名或注册邮箱地址。如何查找：登录 WordPress 后台 → 右上角查看用户信息，或进入"用户" → "所有用户"查看。</small>
            </div>
            <div class="form-row">
              <label for="wpAppPassword">WordPress 应用密码</label>
              <input type="password" id="wpAppPassword" name="wpAppPassword" value="KwYn WspZ W7iQ uUoh d73y BIji" placeholder="请输入 WordPress 应用密码（格式：xxxx xxxx xxxx xxxx）" required />
              <small>推荐使用 WordPress 应用密码，格式类似 xxxx xxxx xxxx xxxx。在 WordPress 后台 → 用户 → 个人资料 → 应用密码 中创建。</small>
            </div>
            <div class="form-row">
              <label for="useElementor" style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                <input type="checkbox" id="useElementor" name="useElementor" style="width: auto; margin: 0;" checked />
                <span>使用 Elementor 保存页面（推荐，默认开启）</span>
              </label>
              <small>系统将默认通过 Elementor 保存页面，以更好地保留 HTML / CSS / JS。如站点未安装 Elementor，将自动回退到标准方式。</small>
            </div>
          </fieldset>

          <fieldset>
            <legend>📝 内容信息</legend>
            <div class="form-row">
              <label for="keyword">长尾关键词</label>
              <input type="text" id="keyword" name="keyword" placeholder="女士最佳防水登山鞋推荐" />
              <small>输入要生成内容的长尾关键词（英式英语）。如果使用关键词池，此字段可以为空。</small>
            </div>
            <div class="form-row">
              <label for="useKeywordPool" style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                <input type="checkbox" id="useKeywordPool" name="useKeywordPool" style="width: auto; margin: 0;" />
                <span>使用关键词池（批量生成）</span>
              </label>
              <small>勾选后，将使用下方的关键词池进行批量生成，每个关键词生成一篇页面。系统会自动循环选择模板和标题类型。</small>
            </div>
            <div class="form-row" id="keywordPoolRow" style="display: none;">
              <label for="keywordPool">关键词池（每行一个关键词）</label>
              <textarea id="keywordPool" name="keywordPool" rows="6" placeholder="例如：&#10;luxury smartphone buying guide&#10;best android phone reviews&#10;how to choose premium mobile phone&#10;&#10;每行一个关键词，系统将循环使用模板和标题类型为每个关键词生成页面"></textarea>
              <small>输入多个长尾关键词，每行一个。系统将自动循环选择模板（模板1、模板2、模板3、模板4）和标题类型，为每个关键词生成一篇页面。</small>
            </div>
            <div class="form-row">
              <label>页面模板</label>
              <div class="template-selector" id="templateSelector">
                <input type="hidden" id="templateType" name="templateType" value="template-1" required>
                
                <div class="template-card" data-template="template-1">
                  <div class="template-card-image">
                    <img src="https://vertu-website-oss.vertu.com/2025/12/Preview-3-scaled.jpg" alt="模板1预览" loading="lazy">
                    <div class="template-card-overlay">
                      <button type="button" class="preview-btn" data-preview="https://vertu-website-oss.vertu.com/2025/12/Preview-3-scaled.jpg">Preview</button>
                    </div>
                  </div>
                  <div class="template-card-content">
                    <h3>模板1</h3>
                    <p>标题+内容+第一排产品+第二排产品</p>
                    <div class="template-card-check">
                      <span class="check-icon">✓</span>
                    </div>
                  </div>
                </div>

                <div class="template-card" data-template="template-2">
                  <div class="template-card-image">
                    <img src="https://vertu-website-oss.vertu.com/2025/12/screencapture-vertu-luxury-life-guides-how-to-choose-the-best-sapphire-screen-phone-2025-12-04-14_41_47-scaled.jpg" alt="模板2预览" loading="lazy">
                    <div class="template-card-overlay">
                      <button type="button" class="preview-btn" data-preview="https://vertu-website-oss.vertu.com/2025/12/screencapture-vertu-luxury-life-guides-how-to-choose-the-best-sapphire-screen-phone-2025-12-04-14_41_47-scaled.jpg">Preview</button>
                    </div>
                  </div>
                  <div class="template-card-content">
                    <h3>模板2</h3>
                    <p>标题+第一排产品+内容+第二排产品</p>
                    <div class="template-card-check">
                      <span class="check-icon">✓</span>
                    </div>
                  </div>
                </div>

                <div class="template-card" data-template="template-3">
                  <div class="template-card-image">
                    <img src="https://vertu-website-oss.vertu.com/2025/12/Preview-1-scaled.jpg" alt="模板3预览" loading="lazy">
                    <div class="template-card-overlay">
                      <button type="button" class="preview-btn" data-preview="https://vertu-website-oss.vertu.com/2025/12/Preview-1-scaled.jpg">Preview</button>
                    </div>
                  </div>
                  <div class="template-card-content">
                    <h3>模板3</h3>
                    <p>标题+第一排产品+内容+第二排产品+内容（无字数限制）</p>
                    <div class="template-card-check">
                      <span class="check-icon">✓</span>
                    </div>
                  </div>
                </div>

                <div class="template-card" data-template="template-4">
                  <div class="template-card-image">
                    <img src="https://vertu-website-oss.vertu.com/2025/12/screencapture-vertu-luxury-life-guides-top-10-best-rated-prepaid-cell-phones-complete-ranking-list-2025-12-11-14_26_52-scaled.jpg" alt="模板4预览" loading="lazy">
                    <div class="template-card-overlay">
                      <button type="button" class="preview-btn" data-preview="https://vertu-website-oss.vertu.com/2025/12/screencapture-vertu-luxury-life-guides-top-10-best-rated-prepaid-cell-phones-complete-ranking-list-2025-12-11-14_26_52-scaled.jpg">Preview</button>
                    </div>
                  </div>
                  <div class="template-card-content">
                    <h3>模板4</h3>
                    <p>标题+Top Picks+对比表+内链+产品区</p>
                    <div class="template-card-check">
                      <span class="check-icon">✓</span>
                    </div>
                  </div>
                </div>
              </div>
              <small>点击卡片选择模板，点击Preview按钮查看全屏预览</small>
            </div>
            <div class="form-row required">
              <label for="titleType">标题类型</label>
              <select id="titleType" name="titleType" required>
                <option value="">-- 请选择标题类型 --</option>
                <option value="purchase">Purchase/Transaction（购买/交易）</option>
                <option value="informational">Informational/Guide（信息/指南）</option>
                <option value="review">Review/Comparison（评论/比较）</option>
                <option value="commercial">Commercial/Deal（商业/优惠）</option>
                <option value="how-to">How to（如何）</option>
                <option value="recommendations">Recommendations（推荐）</option>
                <option value="services-guides">Services Guides（服务指南）</option>
                <option value="tech-insights">Tech Insights（技术洞察）</option>
                <option value="comparison">Comparison（比较）</option>
                <option value="expert">Expert/Authority（专家/权威）</option>
                <option value="best">Best（最佳）</option>
                <option value="top">Top（顶级）</option>
                <option value="top-ranking">Top Ranking（排名榜单）</option>
                <option value="most">Most（最多/最受欢迎）</option>
              </select>
              <small>选择标题类型，系统将根据关键词和选择的类型生成对应的标题</small>
            </div>
            <div class="form-row">
              <label for="pageTitle">页面标题（可选）</label>
              <input type="text" id="pageTitle" name="pageTitle" placeholder="留空将根据长尾词和选择的类型自动生成标题" />
              <small>如果留空，系统将根据长尾词和选择的标题类型自动生成一个包含该关键词的标题（英式英语）</small>
            </div>
            <div class="form-row">
              <label for="userPrompt">内容提示词（可选）</label>
              <textarea id="userPrompt" name="userPrompt" rows="4" placeholder="例如：重点介绍产品的工艺特色、强调品牌的奢华定位、突出产品的技术创新等...&#10;如果填写，AI将按照您的提示词和想法来生成内容" style="min-height: 100px; font-family: inherit;"></textarea>
              <small>您可以提供内容创作的想法和方向，AI将根据您的提示词生成更符合需求的内容。留空则使用默认策略。</small>
            </div>
            <div class="form-row">
              <label for="targetCategory">指定产品分类（可选）</label>
              <input type="text" id="targetCategory" name="targetCategory" placeholder="例如：Phones, Agent Q, quantum-flip 或 agent-q,quantum-flip（支持多个分类，用逗号分隔）" />
              <small>如果填写，页面将只显示该分类下的产品。支持模糊匹配，可以输入分类名称或slug，支持多个分类（用逗号分隔）。留空则根据关键词自动匹配产品。</small>
            </div>
            <!-- 模板内容已隐藏，系统会自动加载对应模板 -->
            <div class="form-row" style="display: none;">
              <label for="templateFile">上传 HTML 模板（可选）</label>
              <input type="file" id="templateFile" name="templateFile" accept=".html,.hbs,.handlebars,.txt" />
              <small>默认模板已自动加载。如需使用自定义模板，请上传文件。模板需包含占位符：{{PAGE_TITLE}}、{{{AI_GENERATED_CONTENT}}}、{{#each products}}...</small>
            </div>
            <div class="form-row" style="display: none;">
              <label for="templateContent">模板内容</label>
              <textarea id="templateContent" name="templateContent" rows="12" placeholder="默认模板已自动加载，或在此粘贴自定义 HTML 模板"></textarea>
            </div>
          </fieldset>

          <button type="submit" class="primary-btn" id="submit-btn">
            <span class="btn-text">🚀 生成并发布</span>
            <span class="btn-loader" style="display: none;">
              <span class="spinner"></span>
              <span>处理中...</span>
            </span>
          </button>
        </form>
      </section>

      <section class="card" id="progress-card">
        <h2 style="margin-top: 0; margin-bottom: 1.5rem; display: flex; align-items: center; justify-content: space-between;">
          <span>📊 任务进度</span>
          <div style="display: flex; gap: 0.5rem;">
            <button type="button" id="pause-task-btn" class="secondary-btn" style="padding: 0.5rem 1rem; font-size: 0.9rem; display: none;">
              ⏸️ 暂停
            </button>
            <button type="button" id="resume-task-btn" class="secondary-btn" style="padding: 0.5rem 1rem; font-size: 0.9rem; display: none;">
              ▶️ 继续
            </button>
          </div>
        </h2>
        
        <!-- 进度条 -->
        <div class="progress-bar-container">
          <div class="progress-bar-wrapper">
            <div id="progress-bar" class="progress-bar" style="width: 0%">
              <span id="progress-text" class="progress-text">0%</span>
            </div>
          </div>
          <div id="progress-status" class="progress-status">等待开始...</div>
        </div>

        <!-- 进度日志 -->
        <div id="progress-log" class="progress-log">
          <p>提交表单后将在此显示流程进度。</p>
        </div>
      </section>

      <!-- 历史记录查看 -->
      <section class="card" id="history-section">
        <h2 style="margin-top: 0; margin-bottom: 1.5rem; display: flex; align-items: center; justify-content: space-between;">
          <span>📋 生成历史记录</span>
          <div style="display: flex; gap: 0.5rem;">
            <button type="button" id="refresh-history-btn" class="secondary-btn" style="padding: 0.5rem 1rem; font-size: 0.9rem;">
              🔄 刷新
            </button>
            <button type="button" id="clear-history-btn" class="secondary-btn" style="padding: 0.5rem 1rem; font-size: 0.9rem; background: var(--error-color); color: white;">
              🗑️ 清空
            </button>
          </div>
        </h2>
        <div style="margin-bottom: 1rem; display: flex; gap: 1rem; flex-wrap: wrap;">
          <input type="text" id="history-search" placeholder="搜索关键词或标题..." style="flex: 1; min-width: 200px; padding: 0.5rem 1rem; border: 2px solid var(--border-color); border-radius: 8px;" />
          <select id="history-status-filter" style="padding: 0.5rem 1rem; border: 2px solid var(--border-color); border-radius: 8px;">
            <option value="">全部状态</option>
            <option value="completed">已完成</option>
            <option value="failed">失败</option>
          </select>
        </div>
        <div id="history-list" class="history-list">
          <p style="text-align: center; color: var(--text-secondary); padding: 2rem;">加载中...</p>
        </div>
      </section>
    </main>

    <template id="product-template-hint">
      <pre>
&lt;h1&gt;{{PAGE_TITLE}}&lt;/h1&gt;
&lt;article&gt;{{AI_GENERATED_CONTENT}}&lt;/article&gt;
&lt;section class="related-products"&gt;
  &lt;h2&gt;相关产品推荐&lt;/h2&gt;
  {{#if products.length}}
    {{#each products}}
      &lt;div class="product-card"&gt;
        {{#if this.imageUrl}}
          &lt;img src="{{this.imageUrl}}" alt="{{this.name}}" /&gt;
        {{/if}}
        &lt;h3&gt;&lt;a href="{{this.link}}" target="_blank" rel="noopener"&gt;{{this.name}}&lt;/a&gt;&lt;/h3&gt;
        {{#if this.category}}
          &lt;p&gt;分类: {{this.category}}&lt;/p&gt;
        {{/if}}
      &lt;/div&gt;
    {{/each}}
  {{else}}
    &lt;p&gt;暂无相关产品。&lt;/p&gt;
  {{/if}}
&lt;/section&gt;
      </pre>
    </template>

    <script src="main.js" type="module"></script>
  </body>
</html>
